(this["webpackJsonpblog-frontend"]=this["webpackJsonpblog-frontend"]||[]).push([[0],{14:function(e,t,n){"use strict";n.r(t);var r=n(7),a=n.n(r),c=n(5),o=n(1),s=n.n(o),u=n(3),i=n(4),l=n(2),j=n(0),b=function(e){var t=e.handlePost,n=e.blog,r=e.handleBlogTitle,a=e.handleBlogAuthor,c=e.handleBlogUrl;return Object(j.jsxs)("form",{onSubmit:t,children:[Object(j.jsxs)("div",{children:["title: ",Object(j.jsx)("input",{type:"text",value:n.title,onChange:r})]}),Object(j.jsxs)("div",{children:["author: ",Object(j.jsx)("input",{type:"text",value:n.author,onChange:a})]}),Object(j.jsxs)("div",{children:["url: ",Object(j.jsx)("input",{type:"text",value:n.url,onChange:c})]}),Object(j.jsx)("button",{type:"submit",children:"post"})]})},h=function(e){var t=e.blogs;return Object(j.jsx)("div",{children:Object(j.jsxs)("p",{children:[Object(j.jsx)("a",{href:t.url,children:t.title})," ",t.author]})})},d=function(e){var t=e.handleLogin,n=e.handleUsername,r=e.handlePassword,a=e.username,c=e.password;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h1",{children:"Login"}),Object(j.jsxs)("form",{onSubmit:t,children:[Object(j.jsxs)("div",{children:["username ",Object(j.jsx)("input",{type:"username",value:a,onChange:n})]}),Object(j.jsxs)("div",{children:["password ",Object(j.jsx)("input",{type:"password",value:c,onChange:r})]}),Object(j.jsx)("button",{type:"submit",children:"Login"})]})]})},p="/api/blogs",O=null,f=function(e){O="bearer ".concat(e)},x=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p,{headers:{authorization:O}});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p,{method:"POST",headers:{"Content-Type":"application/json",authorization:O},body:JSON.stringify(t)});case 2:if((n=e.sent).ok){e.next=5;break}throw Error;case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:O},body:JSON.stringify(t)});case 2:if((n=e.sent).ok){e.next=5;break}throw Error;case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(l.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(l.useState)(null),o=Object(i.a)(a,2),p=o[0],O=o[1],m=Object(l.useState)(null),w=Object(i.a)(m,2),y=w[0],S=w[1],k=Object(l.useState)(""),B=Object(i.a)(k,2),C=B[0],T=B[1],E=Object(l.useState)(""),J=Object(i.a)(E,2),P=J[0],U=J[1],L=Object(l.useState)(null),N=Object(i.a)(L,2),z=N[0],I=N[1],A=Object(l.useState)({title:"",author:"",url:""}),D=Object(i.a)(A,2),F=D[0],W=D[1];Object(l.useEffect)((function(){Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),Object(l.useEffect)((function(){var e=JSON.parse(window.localStorage.getItem("loggedBlogUser"));e&&(I(e),f(e.token))}),[]);var q=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,v({username:C,password:P});case 4:n=e.sent,I(n),f(n.token),window.localStorage.setItem("loggedBlogUser",JSON.stringify(n)),T(""),U(""),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(1),O("Wrong credentials"),T(""),U(""),setTimeout((function(){O(null)}),2e3);case 18:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,g(F);case 4:S("".concat(F.title," by ").concat(F.author," added")),W({title:"",author:"",url:""}),setTimeout((function(){S(null)}),2e3),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Error",e.t0);case 12:return e.next=14,x();case 14:n=e.sent,r(n);case 16:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return null===z?Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{style:{color:"red"},children:p}),Object(j.jsx)(d,{handleLogin:q,handlePassword:function(e){U(e.target.value)},handleUsername:function(e){T(e.target.value)},username:C,password:P})]}):Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{style:{color:"green"},children:y}),Object(j.jsx)("h1",{children:"blogs"}),Object(j.jsx)("p",{children:Object(j.jsxs)("b",{children:[z.name," logged in! ",Object(j.jsx)("button",{onClick:function(){window.localStorage.clear(),I(null)},children:"logout"})]})}),Object(j.jsx)(b,{handlePost:G,blog:F,handleBlogTitle:function(e){W(Object(c.a)(Object(c.a)({},F),{},{title:e.target.value}))},handleBlogAuthor:function(e){W(Object(c.a)(Object(c.a)({},F),{},{author:e.target.value}))},handleBlogUrl:function(e){W(Object(c.a)(Object(c.a)({},F),{},{url:e.target.value}))}}),n.map((function(e){return Object(j.jsx)(h,{blogs:e},e.id)}))]})};a.a.render(Object(j.jsx)(m,{}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.523685f1.chunk.js.map